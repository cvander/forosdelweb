<?php/*======================================================================*\|| #################################################################### |||| # Recomended threads manager - Foros del Web                       # |||| # @author      David Barrios <davidbarriosfdw@gmail.com            # |||| #################################################################### ||\*======================================================================*/function build_fdwtags(){	global $vbulletin;		$fdwtaglist = array();	$fdwtags = $vbulletin->db->query_read("SELECT * FROM " . TABLE_PREFIX . "fdwtag WHERE active = 1 ORDER BY master");	while ($fdwtag = $vbulletin->db->fetch_array($fdwtags))	{		if (!$fdwtaglist["$fdwtag[forumid]"])		{			$fdwtaglist["$fdwtag[forumid]"] = array(				'boxtitle' => $fdwtag['boxtitle'],				'sort' => $fdwtag['sort'],				'list' => array()			);		}		$fdwtaglist["$fdwtag[forumid]"]['list']["$fdwtag[fdwtagid]"] = array(			'type' => $fdwtag['type'],			'recomendation' => $fdwtag['recomendation'],			'groupids' => explode(',', $fdwtag['groupids']),			'master' => $fdwtag['master'],			'unreaded' => $fdwtag['unreaded'],			'maxthreads' => $fdwtag['maxthreads'],			'days' => $fdwtag['days']		);	}		build_datastore('fdwtaglist', serialize($fdwtaglist), 1);}function print_fdwtag_script(){	echo '		<script type="text/javascript">			function getParentRow(obj) {				var parentobj = obj;				while (parentobj = parentobj.parentNode) {					if (parentobj.nodeName.toLowerCase() == "tr") {						return parentobj;					}				}			}						function showRow() {				var row = document.getElementById("sel_type_2").value;				fdwRecomendation.tag.style.display = "none";				fdwRecomendation.field.style.display = "none";				if (fdwRecomendation[row]) {					YAHOO.util.Dom.setStyle(fdwRecomendation[row], "display", fdwRecomendation.display);				}			}						var fdwRecomendation = {				"tag": getParentRow(document.getElementById("it_rec_tag_3")),				"field": getParentRow(document.getElementById("sel_rec_field_4")),			};			fdwRecomendation.display = YAHOO.util.Dom.getStyle(fdwRecomendation.tag, "display");						document.getElementById("sel_type_2").onchange = showRow;			showRow();		</script>	';}