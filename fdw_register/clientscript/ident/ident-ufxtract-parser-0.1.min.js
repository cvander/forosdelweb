ident.ufxtract={parserName:"ufxtract",parseUf:10,parseRss:0,parseAtom:0,findProfiles:function(){ident.ufxtract.findContent("twitter.com","Profile","hCard",true);for(var a=0;a<ident.domains.length;a++){if(ident.domains[a].accounts!=null){ident.ufxtract.findContent(ident.domains[a].domain,"Profile","hCard",true);ident.ufxtract.findContent(ident.domains[a].domain,"Resume","hResume",true);ident.ufxtract.findContent(ident.domains[a].domain,"Services","XFN",true)}}},findContent:function(d,j,c,h){var a="";var b="";for(var f=0;f<ident.domains.length;f++){if(ident.domains[f].domain==d){if(ident.domains[f].accounts!=null){var e=ident.domains[f];for(var k=0;k<e.accounts.length;k++){var g=e.accounts[k];var a=ident.getAPIEndPoint(j,c,e.urlmappings,g,1);if(a!=""){b=e.name;break}}}}}if(b!=""&&a!=""){if(h==true){if(ident.hasAPIBeenCalled(a,c,"")==false){ident.ufxtract.loadContent(a,d,b,j,c)}}else{ident.ufxtract.loadContent(a,d,b,j,c)}}},loadContent:function(b,e,a,c,d){if(ident.hasAPIBeenCalled(b,d,"")==false){ident.ufxtract._getJson(b,e,a,c,d)}},_getJson:function(b,e,a,c,d){if(d=="rel-tag"){d="tag"}apiurl="http://ufxtract.com/api/?url="+encodeURIComponent(b)+"&format="+d+"&output=json";var f=new ident.historyItem(b,apiurl);f.apiName="ufxtract";f.name=a;f.domain=e;f.schema=d;f.contentType=c;ident.appendAllProfileUrls(b);if(e=="twitter.com"&&ident.getEnchancedTwitterProfile&&d=="hCard"){ident.getEnchancedTwitterProfile(b,"ufxtract")}else{ident.history[ident.history.length]=f;ident.ufxtract._UfXtractAPICall(b,f)}},_parseUfData:function(f,a,d){if(ident.hasAPIBeenCalled(a,d.schema,"")){ident._apiReturnCount++;d.rawJSON=f;ident.ufxtract._processUfJson(f,a,d.domain,d.name,d.contentType);if(d.schema=="hCard"){for(var b=0;b<ident.history.length;b++){var c=false;for(var e=0;e<ident.profiles.length;e++){if(ident.history[b].domain==ident.profiles[e].domain){c=true}}if(c==false){ident.ufxtract._processUfJson(ident.history[b].rawJSON,ident.history[b].url,ident.history[b].domain,ident.history[b].name,ident.history[b].contentType)}}}}},_processUfJson:function(h,b,f,a,d){if(h.microformats){h=h.microformats;if(h.hentry){if(h.hentry.length>0){for(var c=0;c<h.hentry.length;c++){h.hentry[c].sourceUrl=b;h.hentry[c].domain=f;h.hentry[c].name=a;h.hentry[c].type=d;ident.postProcesshEntry(h.hentry[c]);ident.entries[ident.entries.length]=h.hentry[c]}}ident.contentAddedEvent()}if(h.vevent){if(h.vevent.length>0){for(var c=0;c<h.vevent.length;c++){h.vevent[c].sourceUrl=b;h.vevent[c].domain=f;h.vevent[c].name=a;h.vevent[c].type=d;ident.postProcesshCalendar(h.vevent[c]);ident.events[ident.events.length]=h.vevent[c]}}ident.contentAddedEvent()}if(h.tag){if(h.tag.length>0){for(var c=0;c<h.tag.length;c++){h.tag[c].sourceUrl=b;h.tag[c].domain=f;h.tag[c].name=a;h.tag[c].type=d;parts=h.tag[c].tag.split(";_");if(parts.length>1){h.tag[c].tag=parts[0]}ident.tags[ident.tags.length]=h.tag[c]}}ident.contentAddedEvent()}if(h.vcard){if(h.vcard.length>0){var g=ident.findRepresentativehCard(h.vcard,f);if(g!=null){g.sourceUrl=b;g.domain=f;g.name=a;if(g.url){for(var c=0;c<g.url.length;c++){ident.appendDeclaredProfileUrl(g.url[c]);ident.appendDomainNode("",g.url[c],false,"");ident.appendAllProfileUrls(g.url[c])}ident.postProcessDomainNode()}if(g.logo){if(ident.isString(g.logo)==false){g.logo=""}}if(g.logo){if(ident.isString(g.logo)==false){g.logo=""}}if(g.fn){ident.appendFormattedName(g.fn.replace("  "," "))}if(g.fn!=""){ident.profiles[ident.profiles.length]=g}}}ident.createCombinedhCard();ident.profileAddedEvent()}if(h.xfn){if(h.xfn.length){for(var c=0;c<h.xfn.length;c++){h.xfn[c].sourceUrl=b;h.xfn[c].domain=f;h.xfn[c].name=a;h.xfn[c].type=d;ident.xfn[ident.xfn.length]=h.xfn[c];if(ident.containsMe(h.xfn[c].rel)){ident.mes[ident.mes.length]=h.xfn[c];ident.appendDeclaredProfileUrl(h.xfn[c].link);ident.appendDomainNode("",h.xfn[c].link,false,"");ident.appendAllProfileUrls(h.xfn[c].link)}}ident.postProcessDomainNode()}}if(h.hresume){var e=false;for(var c=0;c<ident.profiles.length;c++){if(ident.profiles[c].domain==f){e=true;ident.profiles[c].note=new Array();if(h.hresume[0].summary!=undefined){if(h.hresume[0].summary!=""){ident.profiles[c].note[0]=h.hresume[0].summary}}}ident.createCombinedhCard();ident.profileAddedEvent()}if(e==false&&h.hresume[0].contact){hcard=h.hresume[0].contact;hcard.sourceUrl=b;hcard.domain=f;hcard.name=a;if(h.hresume[0].summary!=undefined){if(h.hresume[0].summary!=""){hcard.note[0]=h.hresume[0].summary}}if(hcard.fn!=""){ident.profiles[ident.profiles.length]=hcard}ident.createCombinedhCard();ident.profileAddedEvent()}if(h.hresume.length>0){for(var c=0;c<h.hresume.length;c++){h.hresume[c].sourceUrl=b;h.hresume[c].domain=f;h.hresume[c].name=a;ident.resumes[ident.resumes.length]=h.hresume[c]}}}}},_UfXtractAPICall:function(a,b){jQuery.getJSON(apiurl+"&callback=?",function(c){ident.ufxtract._parseUfData(c,a,b)})}};ident.registerParser(ident.ufxtract);